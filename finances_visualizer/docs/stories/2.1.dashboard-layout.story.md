# Story 2.1: Dashboard Layout and Summary Cards

## Story Metadata

```yaml
epic: 2
story: 1
title: Dashboard Layout and Summary Cards
status: Draft
created: 2026-02-03
estimated_days: 2
complexity: Medium

clickup:
  task_id: ""
  epic_task_id: ""
  list: "Backlog"
  url: ""
  last_sync: ""
```

---

## User Story

**As a** user,
**I want** to see a clean dashboard with summary statistics at the top,
**so that** I can immediately understand my financial health.

---

## Acceptance Criteria

1. Responsive grid layout: 4 summary cards on desktop, 2x2 on tablet, stacked on mobile
2. Each card shows: icon, label, value, mini-sparkline or trend indicator
3. Cards: Total Income (green), Total Expense (red), Net Balance (blue/gold), Transaction Count
4. Cards use glassmorphism effect (backdrop-blur, semi-transparent bg)
5. Hover effect: slight scale (1.02x) and glow
6. Values formatted as BRL (R$ 1.234,56)
7. Loading skeleton state while data processes
8. Empty state when no data uploaded

---

## Requirements Mapping

| AC | Functional Requirement | Notes |
|----|----------------------|-------|
| AC1 | FR6, NFR6 | Responsive layout |
| AC2 | FR12 | Card content |
| AC3 | FR12 | Card types |
| AC4 | UI Design Goals | Glassmorphism |
| AC5 | UI Design Goals | Micro-interactions |
| AC6 | FR12 | Currency format |
| AC7 | FR10 | Loading state |
| AC8 | - | Empty state |

---

## ğŸ¤– CodeRabbit Integration

> **CodeRabbit Integration**: Enabled

### Story Type Analysis

- **Primary Type**: Frontend
- **Secondary Type(s)**: None
- **Complexity**: Medium (responsive layout, animations)

### Specialized Agent Assignment

- **Primary Agents**: @dev (layout + components)
- **Supporting Agents**: None

### Quality Gate Tasks

- [ ] Pre-Commit (@dev): Run `coderabbit --prompt-only -t uncommitted` before marking story complete
- [ ] Pre-PR (@github-devops): Run `coderabbit --prompt-only --base main` before creating pull request

### CodeRabbit Focus Areas

**Primary Focus:**
- Responsive grid works on all breakpoints (320px - 1920px+)
- Glassmorphism effect matches PRD design (backdrop-blur, semi-transparent)
- Currency formatting uses BRL format correctly
- Loading skeleton prevents layout shift

**Secondary Focus:**
- Hover animations are smooth (60fps)
- Accessibility: keyboard navigation, screen reader support
- Empty state provides clear CTA

### Self-Healing Configuration

```
Expected Self-Healing:
  - Primary Agent: @dev (light mode)
  - Max Iterations: 2
  - Timeout: 15 minutes
  - Severity Filter: CRITICAL only
```

---

## Dev Notes

### Layout Structure [Source: PRD UI Design Goals]

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Incomeâ”‚ â”‚Expenseâ”‚ â”‚Balanceâ”‚ â”‚ Count â”‚  Cards  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   Chart 1  â”‚ â”‚   Chart 2  â”‚   Charts (2x2)      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚   Chart 3  â”‚ â”‚   Chart 4  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Transaction Table (scrollable)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Responsive Breakpoints [Source: PRD Target Platforms]

```css
/* Mobile: 320px - 768px */
.grid { grid-template-columns: 1fr; }

/* Tablet: 768px - 1024px */
.grid { grid-template-columns: repeat(2, 1fr); }

/* Desktop: 1024px+ */
.grid { grid-template-columns: repeat(4, 1fr); }
```

### Glassmorphism Effect [Source: PRD Branding]

```css
.glass-card {
  background: rgba(15, 23, 42, 0.6);      /* Dark semi-transparent */
  backdrop-filter: blur(12px);             /* Blur effect */
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}
```

### Card Components

Location: `src/components/Dashboard.tsx`

**Props:**
```typescript
interface SummaryCardProps {
  type: 'income' | 'expense' | 'balance' | 'count';
  value: number;
  trend?: number;  // Optional sparkline/trend
  loading?: boolean;
}
```

**Card Types:**
- Income â†’ Green (#10b981), icon: arrow-up
- Expense â†’ Red (#f43f5e), icon: arrow-down
- Balance â†’ Blue/Gold, icon: wallet
- Count â†’ Purple, icon: list

### Currency Formatting [Source: PRD]

Location: `src/lib/format.ts`

```typescript
function formatBRL(value: number): string {
  return new Intl.NumberFormat('pt-BR', {
    style: 'currency',
    currency: 'BRL'
  }).format(value);
}

// Example: 1234.56 â†’ "R$ 1.234,56"
```

### Loading States

Use skeleton screens:

```typescript
// Shimmer effect
.loading {
  background: linear-gradient(
    90deg,
    rgba(255,255,255,0) 0%,
    rgba(255,255,255,0.05) 50%,
    rgba(255,255,255,0) 100%
  );
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}
```

### Empty State

When no data uploaded:
- Show 4 skeleton cards
- Or show message: "FaÃ§a upload de um CSV para comeÃ§ar"
- Display upload CTA button

---

## Tasks / Subtasks

### Task 1: Create Dashboard Layout (AC: 1)

- Create `src/pages/Dashboard.tsx`
- Create responsive grid (CSS Grid or Flexbox)
- Configure breakpoints for mobile/tablet/desktop
- Test on different screen sizes

### Task 2: Create SummaryCard Component (AC: 2, 3)

- Create `src/components/SummaryCard.tsx`
- Accept type, value, trend props
- Display icon + label + value
- Apply colors based on type

### Task 3: Implement Glassmorphism Styling (AC: 4)

- Add glassmorphism CSS classes
- Configure Tailwind custom classes
- Apply backdrop-filter effect
- Add subtle border

### Task 4: Add Hover Effects (AC: 5)

- Add Framer Motion or CSS transitions
- Scale: 1.02x on hover
- Add glow effect (box-shadow)
- Ensure 60fps animations

### Task 5: Format Currency Display (AC: 6)

- Create `formatBRL()` utility
- Use Intl.NumberFormat
- Handle edge cases (NaN, Infinity)

### Task 6: Create Loading Skeleton (AC: 7)

- Create `src/components/LoadingCard.tsx`
- Add shimmer animation
- Match card dimensions
- Prevent layout shift

### Task 7: Create Empty State (AC: 8)

- Create `src/components/EmptyState.tsx`
- Show message when no data
- Add upload CTA
- Style with dark theme

### Task 8: Connect to Summary Data

- Integrate with aggregation functions (Story 1.5)
- Fetch summary data on mount
- Display real values in cards
- Handle loading/error states

### Task 9: Create Tests (Coverage)

- Test responsive layout
- Test currency formatting
- Test loading states
- Test empty state
- Test hover interactions

---

## Testing Strategy

### Unit Tests (Vitest)

- Currency formatting with various values
- Card component rendering
- Layout breakpoint calculations

### Visual Regression Tests

- Mobile view (320px)
- Tablet view (768px)
- Desktop view (1024px+)
- Loading states
- Empty states

### Manual Testing

1. Upload CSV and verify cards display
2. Check values are correct
3. Test on mobile phone
4. Test hover animations
5. Verify loading state appears before data

---

## Definition of Done

- [x] All acceptance criteria met
- [x] Responsive grid working on all breakpoints
- [x] 4 summary cards with correct data
- [x] Glassmorphism effect applied
- [x] Hover animations smooth
- [x] Currency formatted as BRL
- [x] Loading skeleton prevents layout shift
- [x] Empty state with CTA
- [x] Tests passing
- [x] CodeRabbit review passed

---

*Story created by AIOS Framework*
*Scrum Master: @sm (River)*
*Date: 2026-02-03*
